# Predicting Drug Response in Breast Cancer Using Deep Learning Neural Networks

<h2>Overview</h2><br>
In a study by Chawla et al., they suggested a deep learning model called Precily that incorporated various data including cell line data, pathways scores, and drug descriptor data in order to develop an accurate drug response prediction model. In this project, additional mutation data was incorporated to further improve drug response prediction through a similar approach taken by Taj et al. in their MMDRP model. The original deep learning Precily model was updated to include the additional mutation data as additional features and was re-trained to generate an updated trained deep learning model. <br> <br>

Chawla et al. original Precily Model: https://github.com/SmritiChawla/Precily <br>
Taj et al. MMDRP Model: https://github.com/LincolnSteinLab/MMDRP 
<h2>Code Overview</h2>
<p>This GitHub repository will provide all the required data and code to run the modified version of Precily. The following is the breakdown of how the project comes together</p>
<ol>
  <li><b>/1.MutationDataMerge/</b></li>
  <p>This folder provides all the data and code to create the new test and trained dataset. Within the folder are the original dataset, the mutation data, the code to create the new training and test set. Mutation data merge with pathway scores and drug descriptors was done in 3 steps. <br> </p>
  <b>1.Mutation_DataFiltering.R</b> <br>
  This file takes mutation data provided by the DepMap portal in their 20Q1 release (<b>CCLE_mutations.csv</b>), trims unnecessary columns, and overlaps mutations with Cosmic Cancer Gene Cencus data (<b>cancer_gene_census.csv</b>) where it was first converted to GRCh38 format using the liftOver Library (<b>hg19ToHg38.over.chain</b>) and generates a table of size 1580 rows by 495 columns where each row indicated the cell line and indications if a certain mutation was present or not (<b>FILTERD_DepMap_21Q2_Mutations_by_Cell.csv</b>). <br><br>
  <b>2.DataSetMerge.py</b><br>
  This file merges the mutation matrix created in 1.Mutation_DataFiltering.R with the original Pathway+DrugDescriptors   
  training and test set (<b>/Orignal_dataset</b>). <br><br>
  <b>Manual Update</b><br>
  The merged training and test set created in part 2 required additional manual configuration, the IC50 column was moved to   
  the last column. The completely merged training and test set are located at <b>/Mutation+OldData/</b>
  <br><br>
  <li><b>/2.PrecilyTraining/</b></li>
  This folder contains the python script used to create and train the modified precily, along with pre-trained models.<br><br>
  
  <b>Precily_Training.py</b> <br>
  This python script creates and trains the modified Precily model. This is done by first tuning several hyper-parameters through the Keras Tuner library through the use of a 
  5-fold cross validation on the training set for 30 epochs resulting in 5 models, then the models are fitted to the whole training set. The hyper-parameters that were tuned 
  are listed below:
  <ul>
    <li>Number of layers (2-6)</li>
    <li>Number of Neurons (128-256, step size 4)</li>
    <li>Drop Out Rate (.1, .2, .3, .4, .5)</li>
   <li>Learning Rate (1e-3, 1e-4, 1e-5)</li>
  </ul> <br>
  <b>/PrecilyOriginalPretrainedModels</b><br>
  The orignal Pretrained Precily models are contain here.<br><br>

  <b>/ModifiedPrecilyPretrainedModels</b><br>
  Models generated by the modified precily with the updated training set (Mutation+Pathway+DrugDescriptors). These models     are only partially trained due to error encounterd while running the python training script. <br><br>
  
  <li><b>/3.Evaluation/</b></li>
  This folder provides the code to replicate the results from the paper. The code provided in this folder was also used to evaluate the performance of the newly trained models.  <br><br>
  <b>Fig1c: </b> <br>
  Assesses the performance of Precily models and outputs correlation values for each drug<br><br>
  <b>Fig1d: </b> <br>
  Evaluate model performance on test dataset<br><br>
  <b>Fig2b: </b> <br>
  Provides the code for assessing the efficiency of Precily on an independent dataset of scRNA-seq profiles of MDA-MB-231 breast cancer cells (dataset by Lee et al.)<br><br>
  <b>Fig4b: </b> <br>
  Evaluate the model for making predictions on PCa xenograft data.
  
</ol>
